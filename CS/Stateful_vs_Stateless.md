# 무상태 (Stateless) vs 상태유지 (Stateful)

네트워크 프로토콜과 서버 설계에서 매우 중요한 개념인 무상태(Stateless)와 상태유지(Stateful)를 정리합니다.

---

## 1. 무상태 (Stateless)
서버가 클라이언트의 이전 상태를 **저장하지 않는** 방식입니다.

- **특징**: 클라이언트가 보내는 모든 요청은 독립적이며, 요청 그 자체로 필요한 모든 정보를 포함해야 합니다.
- **비유**: 햄버거 가게에서 점원이 매번 바뀌는 상황. "치즈버거 줘" -> "콜라 줘" (점원: "무슨 버거요?") -> "치즈버거랑 같이 먹을 콜라 줘"라고 매번 다 말해야 함.
- **장점**:
    - **확장성(Scalability) 높음**: 서버가 클라이언트 상태를 안 들고 있으니, 아무 서버나 응답해도 상관없습니다. (Scale-out 유리)
    - **서버 부담 적음**: 클라이언트의 세션 정보를 유지할 필요가 없습니다.
- **단점**: 클라이언트가 보내는 요청 데이터의 양이 많아집니다. (매번 모든 정보를 다 보내야 하므로)
- **대표 예시**: **HTTP**, **REST API**

---

## 2. 상태유지 (Stateful)
서버가 클라이언트의 이전 상태를 **저장하고 기억하는** 방식입니다.

- **특징**: 서버가 "이 손님은 아까 무슨 말을 했지?"를 기억하므로, 클라이언트는 바뀐 정보만 보내면 됩니다.
- **비유**: 단골집 사장님. "평소 먹던 걸로 줘"라고만 해도 찰떡같이 알아들음.
- **장점**: 요청 데이터가 간결해지고 사용자 경험이 매끄러울 수 있습니다.
- **단점**:
    - **확장성 낮음**: 클라이언트의 상태를 들고 있는 특정 서버와만 계속 통신해야 합니다. (서버 장애 시 상태가 다 날아감)
- **대표 예시**: **TCP** (연결 확립 후 통신), 일반적인 로그인 세션 유지 방식.

---

## 3. 왜 HTTP는 Stateless를 선택했을까?
웹은 수억 명의 사용자가 접속하는 환경입니다. 만약 서버가 수억 명의 상태를 다 기억해야 한다면 서버는 금방 과부하로 터져버릴 것입니다. 

따라서 **서버의 확장성**을 극대화하기 위해 기본적으로 무상태(Stateless) 방식을 채택했습니다.

### 💡 그럼 로그인은 어떻게 유지하나요?
Stateless 환경에서도 로그인을 유지하기 위해 다음과 같은 보조 수단을 사용합니다.
1. **쿠키(Cookie) & 세션(Session)**: 서버나 브라우저에 임시로 정보를 저장.
2. **토큰(JWT)**: 클라이언트가 "나 로그인한 사람이야"라는 증명서(토큰)를 모든 요청마다 제출. (여전히 요청에 모든 정보가 있으므로 Stateless에 가까움)

---

---

## 🚀 [부록] Scale-out vs Scale-up

서버에 사용자가 몰릴 때 성능을 확장하는 두 가지 방법입니다.

### 1. Scale-up (수직 확장)
- **방법**: 기존 서버의 **하드웨어 사양(CPU, RAM, SSD)을 높이는 것**입니다.
- **비유**: 일손이 부족할 때 기존 직원을 '슈퍼맨'으로 업그레이드하는 것.
- **특징**: 설정이 간편하지만, 물리적인 성능 한계가 있고 비용이 기하급수적으로 비싸집니다.

### 2. Scale-out (수평 확장)
- **방법**: 저렴한 성능의 **서버를 여러 대 추가**하여 부하를 분산하는 것입니다.
- **비유**: 일손이 부족할 때 직원을 1명에서 10명으로 늘리는 것.
- **특징**: 이론상 무한 확장이 가능하고, 서버 한 대가 죽어도 서비스가 유지됩니다. 
- **연관성**: **Stateless** 설계가 되어 있어야 어떤 서버가 요청을 받아도 똑같은 처리가 가능하므로, 현대 대규모 서비스의 핵심 기술입니다.

### 📊 비교표
| 구분 | Scale-up (슈퍼맨 만들기) | Scale-out (직원 늘리기) |
| :--- | :--- | :--- |
| **확장 방식** | 성능 업그레이드 | 장비 대수 추가 |
| **비용** | 갈수록 비싸짐 (고성능 장비) | 비교적 저렴 (일반 장비 여러 대) |
| **안정성** | 서버 다운 시 서비스 전체 중단 | 한 대 다운 시에도 다른 서버가 처리 |
| **필요 기술** | 하드웨어 교체 | 로드 밸런싱, Stateless 설계 |

